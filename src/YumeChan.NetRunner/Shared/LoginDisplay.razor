@inject AuthenticationStateProvider AuthenticationStateProvider
@inject NavigationManager NavigationManager

@using System.Security.Claims;

<AuthorizeView>
	<Authorized>
		Welcome, @GetUsername().GetAwaiter().GetResult().&emsp;
		<NavLink class="nav-link text-white mx-2" href="logout">Logout</NavLink>
	</Authorized>

	<NotAuthorized>
		<NavLink class="nav-link text-white mx-1" href=@($"login?redirectUri={CurrentUri}")>Login</NavLink>
	</NotAuthorized>
</AuthorizeView>


@code {
	[Parameter] public string CurrentUri { get; set; }


	public async Task<string> GetUsername()
	{
		AuthenticationState auth = await AuthenticationStateProvider.GetAuthenticationStateAsync();
		return auth.User.FindFirstValue(ClaimTypes.Name);
	}
}
